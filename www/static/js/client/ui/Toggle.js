define(["module","conditioner/Observer","ui/ToggleGroup","ui/ToggleManager","util/Element","util/HashChangeWindow"],function(e,t,n,r,i,s){var o=function(e,t){this._element=e,this._options=t||{},this._initialize()};return o.prototype={_initialize:function(){this._id=this._element.id,this._element.classList.add("toggle"),this._manager=r.getInstance(),this._manager.register(this),this._setStateBind=this._setState.bind(this),t.subscribe(this,"activate",this._setStateBind),t.subscribe(this,"deactivate",this._setStateBind),this._isActive=this.getState()==="activated",this._isActive?this.activate():this.deactivate(),this._options.hash&&(this._hashChangeWindow=s.getInstance(),this._onHashChangeBind=this._onHashChange.bind(this),t.subscribe(this._hashChangeWindow,"hashchange",this._onHashChangeBind))},_onHashChange:function(e){e==this.getId()&&!this.isActive()&&this.activate(!0)},activate:function(){this._isActive=!0,this._element.classList.add("toggle--activated"),this._element.classList.remove("toggle--deactivated");if(this._options.hash&&this._element.id){var e=this;setTimeout(function(){e._hashChangeWindow.setHash(e._element.id)},50)}t.publish(this,"activate",this),this._setState()},deactivate:function(){this._isActive=!1,this._element.classList.add("toggle--deactivated"),this._element.classList.remove("toggle--activated"),t.publish(this,"deactivate",this)},toggle:function(){this._isActive?this.deactivate():this.activate()},getState:function(){return this._element.getAttribute("data-state")},_setState:function(){this._isActive?(this._element.setAttribute("data-state","activated"),this._element.classList.remove("toggle--deactivated"),this._element.classList.add("toggle--activated")):(this._element.setAttribute("data-state","deactivated"),this._element.classList.remove("toggle--activated"),this._element.classList.add("toggle--deactivated"))},getElement:function(){return this._element},getGroup:function(){return this._element.getAttribute("data-toggle-group")},getId:function(){return this._id},isActive:function(){return this._isActive},unload:function(){this._element.classList.remove("toggle--activated"),this._element.classList.remove("toggle--deactivated"),t.unsubscribe(this,"activate",this._setStateBind),t.unsubscribe(this,"deactivate",this._setStateBind)}},o});