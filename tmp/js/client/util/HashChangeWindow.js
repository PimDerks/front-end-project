define(["module","conditioner/Observer"],function(e,t){var n=function(){this._initialize(),window.addEventListener("hashchange",this._onHashChange.bind(this))};n.prototype={_initialize:function(){this._hash=this._getHashFromLocation();if(!this._hash)return},_onHashChange:function(){var e=this._getHashFromLocation();e!=this._hash&&t.publish(this,"hashchange",this._getHashFromLocation())},setHash:function(e){var n=this._getNewHash(e);history.pushState?history.pushState(null,null,n):location.hash=n,t.publish(this,"hashchange",this.getHash())},getHash:function(){return this._hash},_getNewHash:function(e){return this._hash=e,history.pushState?"#"+e:"#!"+e},_getHashFromLocation:function(){return location.hash.replace("#","").replace("!","")}};var r;return{getInstance:function(){return r||(r=new n),r}}});